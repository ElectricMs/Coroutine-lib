### 进程、线程和协程的概念

**进程**

进程是操作系统进行资源分配的基本单位，每个进程都有自己独立内存空间。由于进程比较重量开销的资源多，占独立的内存，所以上下文进程间的切换开销大(栈、寄存器虚拟内存、文件句柄、打开的文件资源信息等)，但相对安全稳定。

**线程**

线程线程是进程的一个实体，是处理器任务调度和执行的基本单位(线程是cpu调度的基本单位)。线程只拥有一点在运行中必不可少的资源(如程序计数器一组寄存器和栈)，但是它可以和同属一个进程的其他线程共享该进程所获得的全部资源。

**协程**

是一种用户态的轻量级线程，协程的调度完全由用户控制(也就是在用户态执行)。协程拥有自己的寄存器和上下文和栈。协程调度切换时，如果是无的情况下将寄存器上下文和栈保存到线程的堆区，在切回来的时候，恢复先前保存的寄存器的上下文和栈，直接操作栈则基本没有内核切换的开销，可以不加锁的访问全局变量，所以上下文的切换非常快。
协程虽然被称为轻量级线程，但在单线程内，协程并不能并发执行，只能是一个协程结束或yield后，再执行另一个协程，而线程则是可以真正并发执行的。其实这点也好理解，毕竟协程只是以一种花里胡哨的方式去运行一个函数，不管实现得如何巧妙，也不可能在单线程里做到同时运行两个函数，否则还要多线程有何用?

相比于多开一个线程来操作，使用协程的好处：

- 减少了线程的重复高频创建；
- 尽量避免线程的阻塞；
- 提升代码的可维护与可理解性（毕竟不需要考虑多线程那一套东西了）；

**如果业务处理时间远小于 IO 耗时，线程切换非常频繁，那么使用协程是不错的选择；**

**并且，协程的优势并不仅仅是减少线程之间切换，从编程的角度来看，协程的引入简化了异步编程；**

**同时，协程为一些异步编程提供了无锁的解决方案；**

即：

**协程可以用同步编程的方式实现异步编程才能实现的功能；**